!function(e,t,o,a){e.noConflict(),e(o).on("click",".media-view",function(o){o.preventDefault();var a=e(this).attr("href");a.length&&e("#media-modal-container").load(a+" #media-modal-container > *",function(){t.history.pushState({href:a},"",a),e("#media-modal").modal("show")})}),e(o).on("click",".media-delete",function(t){t.preventDefault();var o=e(this),a=o.attr("href"),n=o.attr("data-media-id");if(a.length){var i=e(".attachments").children(".attachment").length,d=d||e("#media-modal");bootbox.confirm({message:i18n.media.delete,callback:function(t){bootbox.hideAll(),!0===t&&e.get(a,function(e){toastr.success(e)}).done(function(){--i<=0?location.reload():e("#media-"+n).fadeOut(function(){d.length&&d.modal("hide"),e(this).remove()})}).fail(function(e){toastr.error(e.responseJSON)})}})}}),e(o).on("submit","form.media-update",function(o){o.preventDefault();var a=e(this),n=a.attr("action");if(n.length){var i=i||e("#media-modal"),d={name:e.trim(a.find("#name").val()),description:e.trim(a.find("#description").val())};e.post(n,d,function(e){toastr.success(e)}).done(function(){i.modal("hide"),t.history.pushState({href:Config.adminURL+"/media"},"",Config.adminURL+"/media")}).fail(function(e){console.log(e),toastr.error(e.responseJSON)})}}),e(o).on("hidden.bs.modal","#media-modal",function(o){t.history.pushState({href:Config.adminURL+"/media"},"",Config.adminURL+"/media"),e(this).remove()}),e(o).ready(function(){lazyload();var o=o||e("#media-modal");o.length&&o.modal("show");var a=e("[data-dropzone]");if(a.length)new Dropzone("[data-dropzone]",{url:a.attr("data-upload-url"),success:function(e,o){a.load(t.location.href+" [data-dropzone] .attachments"),toastr.success(o.message)},error:function(e,t,o){toastr.error(t.message)}})})}(window.jQuery||window.Zepto,window,document);
