!function(t,a,e,o){t.noConflict(),t(e).on("click",".media-view",function(e){e.preventDefault();var o=t(this).attr("href");o.length&&t("#media-modal-container").load(o+" #media-modal-container > *",function(){a.history.pushState({href:o},"",o),t("#media-modal").modal("show")})}),t(e).on("click",".media-delete",function(a){a.preventDefault();var e=t(this),o=e.attr("href"),n=e.attr("data-media-id");if(o.length){var i=t(".attachments").children(".attachment").length,d=d||t("#media-modal");bootbox.confirm({message:i18n.media.delete,callback:function(a){bootbox.hideAll(),!0===a&&t.get(o,function(t){toastr.success(t)}).done(function(){--i<=0?location.reload():t("#media-"+n).fadeOut(function(){d.length&&d.modal("hide"),t(this).remove()})}).fail(function(t){toastr.error(t.responseJSON)})}})}}),t(e).on("submit","form.media-update",function(e){e.preventDefault();var o=t(this),n=o.attr("action");if(n.length){var i=i||t("#media-modal"),d={name:t.trim(o.find("#name").val()),description:t.trim(o.find("#description").val())};t.post(n,d,function(t){toastr.success(t)}).done(function(){i.modal("hide"),a.history.pushState({href:Config.adminURL+"/media"},"",Config.adminURL+"/media")}).fail(function(t){toastr.error(t.responseJSON)})}}),t(e).on("hidden.bs.modal","#media-modal",function(e){a.history.pushState({href:Config.adminURL+"/media"},"",Config.adminURL+"/media"),t(this).remove()}),t(e).ready(function(){lazyload();var e=e||t("#media-modal");e.length&&e.modal("show");var o=t("[data-dropzone]");if(o.length)new Dropzone("[data-dropzone]",{url:o.attr("data-upload-url"),success:function(t,e){o.load(a.location.href+" [data-dropzone] .attachments"),toastr.success(e)},error:function(t,a,e){toastr.error(a)}})})}(window.jQuery||window.Zepto,window,document);
