!function(t,a,o,e){t.noConflict(),t(o).on("click",".media-view",function(o){o.preventDefault();var e=t(this).attr("href");e.length&&t("#media-modal-container").load(e+" #media-modal-container > *",function(){a.history.pushState({href:e},"",e),t("#media-modal").modal("show")})}),t(o).on("click",".media-delete",function(a){a.preventDefault();var o=t(this),e=o.attr("href"),n=o.attr("data-media-id");if(e.length){var i=t(".attachments").children(".attachment").length,d=d||t("#media-modal");bootbox.confirm({message:i18n.media.delete,callback:function(a){bootbox.hideAll(),!0===a&&t.get(e,function(t){toastr.success(t)}).done(function(){--i<=0?location.reload():t("#media-"+n).fadeOut(function(){t(this).remove()})}).fail(function(t){toastr.error(t.responseJSON)})}})}}),t(o).on("submit","form.media-update",function(o){o.preventDefault();var e=t(this),n=e.attr("action");if(n.length){var i=i||t("#media-modal"),d={name:t.trim(e.find("#name").val()),description:t.trim(e.find("#description").val())};t.post(n,d,function(t){toastr.success(t)}).done(function(){i.modal("hide"),a.history.pushState({href:Config.adminURL+"/media"},"",Config.adminURL+"/media")}).fail(function(t){toastr.error(t.responseJSON)})}}),t(o).on("hidden.bs.modal","#media-modal",function(o){a.history.pushState({href:Config.adminURL+"/media"},"",Config.adminURL+"/media"),t(this).remove()}),t(o).ready(function(){lazyload();var o=o||t("#media-modal");o.length&&o.modal("show");var e=t("[data-dropzone]");if(e.length)new Dropzone("[data-dropzone]",{url:e.attr("data-upload-url"),success:function(t,o){e.load(a.location.href+" [data-dropzone] .attachments"),toastr.success(o)},error:function(t,a,o){toastr.error(a)}})})}(window.jQuery||window.Zepto,window,document);
